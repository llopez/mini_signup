html(lang="en")
  head
    meta(content="text/html; charset=UTF-8" "http-equiv"="Content-Type")
    meta(charset= "utf-8")
    meta(content="IE=edge" http-equiv="X-UA-Compatible")
    meta(content="width=device-width, initial-scale=1" name="viewport")
    title MiniBattle BA - List
    link(href="css/bootstrap.min.css" rel="stylesheet")
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  body
    .container
      .row
        .col-md-12#content
    script(src="js/react.min.js")
    script(src="js/react-dom.min.js")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js")
    script(src="js/jquery-2.2.4.min.js")
    script(src="js/bootstrap.min.js")
    script(type="text/babel").
      var List = React.createClass({
        getInitialState: function(){
          return {data: []};
        },
        componentDidMount: function(){
          fetch("./api/users")
            .then(function(res){
              return res.json();
            })
            .then((json) => {
              this.setState({data: json});
            })
        },
        render: function(){
          var items = this.state.data.map(function(item){
            return (
              <Item firstName={item.data.first_name} lastName={item.data.last_name} age={item.data.age} />
            );
          });

          return (
            <table className="table table-striped">
            <thead>
            <tr><th>First Name</th><th>Last Name</th><th>Age</th></tr>
            </thead>
            <tbody>
              {items}
            </tbody>
            </table>
          );
        }
      });

      var Item = React.createClass({
        render: function(){
          return (
            <tr><td>{this.props.firstName}</td><td>{this.props.lastName}</td><td>{this.props.age}</td></tr>
          );
        }
      });


      ReactDOM.render(
        <List />,
        document.getElementById('content')
      );
